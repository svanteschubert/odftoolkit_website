<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
  <!--

    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE- 2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->

  <link href="/odftoolkit_website/css/odf.css" rel="stylesheet" type="text/css">
  
  <title></title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-28945571-1']);
    _gaq.push(['_trackPageview']);

    (function () {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>
</head>

<body>

  <div id="banner">
    <!--
    <div id="bannerright"><a alt="Apache Incubator" href="http://incubator.apache.org">
      <img id="asf-logo" alt="Apache Incubator" src="/odftoolkit_website/images/apache-incubator-logo.png"/></a></div>
    <div id="bannercenter"><br/>&nbsp;&nbsp;&nbsp;&nbsp;Apache ODF Toolkit (incubating)</div>
    -->
    <div id="bannerright"><a alt="The Document Foundation" href="https://www.documentfoundation.org/">
        <img id="tdf-logo" class="w220" alt="The Document Foundation"
          src="/odftoolkit_website/images/LibreOffice-Initial-Artwork-Logo-ColorLogoBasic-500px.png" /></a></div>
  </div>
  <div id="clear"></div>
  
  <div id="sidenav">
    <style type="text/css">
/* The following code is added by mdx_elementid.py
   It was originally lifted from http://subversion.apache.org/style/site.css */
/*
 * Hide class="elementid-permalink", except when an enclosing heading
 * has the :hover property.
 */
.headerlink, .elementid-permalink {
  visibility: hidden;
}
h2:hover > .headerlink, h3:hover > .headerlink, h1:hover > .headerlink, h6:hover > .headerlink, h4:hover > .headerlink, h5:hover > .headerlink, dt:hover > .elementid-permalink { visibility: visible }</style>
<h1 id="general">General<a class="headerlink" href="#general" title="Permanent link">&para;</a></h1>
<ul>
<li><a href="/odftoolkit_website/index.html">About</a></li>
<li><a href="/odftoolkit_website/downloads.html">Downloads</a></li>
<li><a href="/odftoolkit_website/license.html">License</a></li>
<li><a href="/odftoolkit_website/privacy.html">Privacy Policy</a></li>
</ul>
<h1 id="components">Components<a class="headerlink" href="#components" title="Permanent link">&para;</a></h1>
<ul>
<li><a href="/odftoolkit_website/odfdom/index.html">ODFDOM</a></li>
<li><a href="/odftoolkit_website/simple/index.html">Simple API (deprecated)</a></li>
<li><a href="/odftoolkit_website/conformance/ODFValidator.html">ODF Validator</a></li>
<li><a href="/odftoolkit_website/xsltrunner/ODFXSLTRunner.html">XSLT Runner</a></li>
</ul>
<h1 id="community">Community<a class="headerlink" href="#community" title="Permanent link">&para;</a></h1>
<ul>
<li><a href="/odftoolkit_website/get-involved.html">Get Involved</a></li>
<li><a href="/odftoolkit_website/mailing-lists.html">Mailing Lists</a></li>
<li><a href="/odftoolkit_website/people.html">People</a></li>
<li><a href="/odftoolkit_website/community-faqs.html">Community FAQs</a></li>
</ul>
<h1 id="development">Development<a class="headerlink" href="#development" title="Permanent link">&para;</a></h1>
<ul>
<li><a href="/odftoolkit_website/source.html">Source Code</a></li>
<li><a href="https://github.com/tdf/odftoolkit/issues">Bug Tracker</a></li>
<li><a href="/odftoolkit_website/javadoc/0.9.0-SNAPSHOT/" target="_blank">JavaDoc</a></li>
<li><a href="odftoolkit.org">Website</a></li>
<li><a href="/odftoolkit_website/developer-faqs.html">Developer FAQs</a></li>
</ul>
<h1 id="tdf">TDF<a class="headerlink" href="#tdf" title="Permanent link">&para;</a></h1>
<ul>
<li><a href="https://www.documentfoundation.org/">The Document Foundation</a></li>
<li><a href="https://www.documentfoundation.org/">Become a Sponsor</a></li>
</ul>
  </div>
  <div id="contenta">
    
      
      <style type="text/css">
/* The following code is added by mdx_elementid.py
   It was originally lifted from http://subversion.apache.org/style/site.css */
/*
 * Hide class="elementid-permalink", except when an enclosing heading
 * has the :hover property.
 */
.headerlink, .elementid-permalink {
  visibility: hidden;
}
h2:hover > .headerlink, h3:hover > .headerlink, h1:hover > .headerlink, h6:hover > .headerlink, h4:hover > .headerlink, h5:hover > .headerlink, dt:hover > .elementid-permalink { visibility: visible }</style>
<p><a href="index.html"><strong>Demos</strong></a> &gt; <b> Offer Letter with Text Fields</b>   </p>
<p><strong>Overview</strong>    </p>
<p>We have introduced several samples about how to use Simple ODF API to generate document from the predefined templete, for example, Demo: <a href="demo3.html">Navigation API in Hotel Receipt</a>. I believe you have known how easy it is. But sounds like, we never talk about how to create a template document using  Simple ODF API.   </p>
<p>Today, let's do it.   </p>
<p>Simple API provides Fields API since version 0.5. OpenDocument text documents or OpenDocument text content embedded in other types of documents may contain variable text elements called fields. Fields are commonly used for, a page number field displays the number of the page on which it appears or a creation date field displays the date on which a document was created. Besides, there are several advance field, such as, variable field and condition field.      </p>
<p>This demo provides a Java application which can create the offer letter template document from a sample and use it to generate new offer letters with the information from a spreadsheet. The template document contains some fields whose content is decided by the information from data file.     </p>
<p>The following picture show a sample offer letter. I have labeled the variable content with blod and color style.    </p>
<p><img alt="image1" src="image/offer-letter-sample.png" />    </p>
<p>This offer was generated on "2011-01-20". It also can be in any other date, so this text content should be replaced by a date field. "Tom King" is the receiver, this name can be replaced with a variable field, then we can send it to any other perpson. Similarly, "software engineer" is the job title of "Tom King", "R&amp;D" is the branch which he belongs to, and "2011-03-12" is his onboard date, all of them should be replaced by variable field in a template document.<br/><br/> 
Salary and allowance are more complex. Different job titles and branches have different rules. Simplicity, we assume that except "Secretary" is 5,500,00, all of the other job titles are 6,000.00. We also assume that employees from "Sales" don't have allowance. Condition field or Hidden Text field is needed to realize these rules. The same as certificates/testimonials, for campus hires, they need supply "Educational certificates", while for professinal hires, they need supply "Experience certificates from previous employers" and "Copy of resignation/acceptation letter and relieving letter". This is another use case of condition field.<br/><br/>
After replaced all of these variable content with fields, the template document is ready. The process of generate new offer letter is very simple. Only need to load the following data, update the variable values with the data and save as a new document.    </p>
<p><img alt="image2" src="image/candidate-data.png" />    </p>
<p>No need text content search, no need target replace. It's faster than the content replace way. Beside, the variable content is highlighted automatically by Symphony or Open Office when the document is opend. The following is a generated letter sample.    </p>
<p><img alt="image3" src="image/generated-offer-letter.png" /></p>
<p>As using fields, the new offer letter is easily updated without inconsistent, even though after generated. You can do it in Symphony or Open Office.
Code Introduction
There are two methods in the class, <code>createFieldTemplate()</code> is used to create template document from sample, and <code>generateOfferLetterDocument()</code> is used to generated new document using template and data file.    </p>
<div class="codehilite"><pre><span></span>public static void main(String[] args) {
    try {
        // create offer letter template with sample offer letter.
        createFieldTemplate();
        // generate offer letters for the candidates from spreadsheet document.
        generateOfferLetterDocument();
    } catch (Exception e) {
        e.printStackTrace();
    }
}
</pre></div>


<p>Below is the source code of method <code>createFieldTemplate()</code>. The basic process is find the variable content and replace it with a field. We use <code>FixedDateField</code>, <code>UserVariableField</code>, <code>ConditionField</code> and <code>HiddenTextField</code> in this method. Simple ODF API provides more types of fields. For more information, please reference the <a href="../document/javadoc/index.html">Javadoc</a> or <a href="../document/cookbook/index.html">CookBook</a>.  </p>
<div class="codehilite"><pre><span></span>public static void createFieldTemplate() throws Exception {
    TextDocument sampleDocument = TextDocument.loadDocument(&quot;Tom&#39;s Offer.odt&quot;);
    // replace offer date with FixedDateField
    TextNavigation search = new TextNavigation(&quot;2011-01-20&quot;, sampleDocument);
    while (search.hasNext()) {
        TextSelection item = (TextSelection) search.nextSelection();
        FieldSelection fieldSelection = new FieldSelection(item);
        fieldSelection.replaceWithSimpleField(Field.FieldType.FIXED_DATE_FIELD);
    }
    // replace candidate name with UserVariableField
    VariableField candidateVar = Fields.createUserVariableField(sampleDocument, &quot;candidateVar&quot;, &quot;Tom King&quot;);
    search = new TextNavigation(&quot;Tom King&quot;, sampleDocument);
    while (search.hasNext()) {
        TextSelection item = (TextSelection) search.nextSelection();
        FieldSelection fieldSelection = new FieldSelection(item);
        fieldSelection.replaceWithVariableField(candidateVar);
    }
    // replace job title with UserVariableField
    VariableField jobTitleVar = Fields.createUserVariableField(sampleDocument, &quot;jobTitleVar&quot;, &quot;software engineer&quot;);
    search = new TextNavigation(&quot;software engineer&quot;, sampleDocument);
    while (search.hasNext()) {
        TextSelection item = (TextSelection) search.nextSelection();
        FieldSelection fieldSelection = new FieldSelection(item);
        fieldSelection.replaceWithVariableField(jobTitleVar);
    }
    // replace branch with UserVariableField
    VariableField branchVar = Fields.createUserVariableField(sampleDocument, &quot;branchVar&quot;, &quot;R&amp;D&quot;);
    search = new TextNavigation(&quot;R&amp;D&quot;, sampleDocument);
    while (search.hasNext()) {
        TextSelection item = (TextSelection) search.nextSelection();
        FieldSelection fieldSelection = new FieldSelection(item);
        fieldSelection.replaceWithVariableField(branchVar);
    }
    // replace onboard date with UserVariableField
    VariableField onBoardDateVar = Fields.createUserVariableField(sampleDocument, &quot;onBoardDateVar&quot;, &quot;2011-03-12&quot;);
    search = new TextNavigation(&quot;2011-03-12&quot;, sampleDocument);
    while (search.hasNext()) {
        TextSelection item = (TextSelection) search.nextSelection();
        FieldSelection fieldSelection = new FieldSelection(item);
        fieldSelection.replaceWithVariableField(onBoardDateVar);
    }
    // replace salary with ConditionField
    search = new TextNavigation(&quot;6,000.00&quot;, sampleDocument);
    while (search.hasNext()) {
        TextSelection item = (TextSelection) search.nextSelection();
        FieldSelection fieldSelection = new FieldSelection(item);
        fieldSelection.replaceWithConditionField(&quot;jobTitleVar != \&quot;Secretary\&quot;&quot;, &quot;6,000.00&quot;, &quot;5,500.00&quot;);
    }
    // replace consolidated allowance with HiddenTextField
    search = new TextNavigation(&quot; and a Consolidated Allowance of 400\\$ per month&quot;, sampleDocument);
    while (search.hasNext()) {
        TextSelection item = (TextSelection) search.nextSelection();
        FieldSelection fieldSelection = new FieldSelection(item);
        fieldSelection.replaceWithHiddenTextField(&quot;branchVar == \&quot;Sales\&quot;&quot;, &quot; and a Consolidated Allowance of 400$ per month&quot;);
    }
    // replace certificates/testimonials with ConditionField
    Fields.createUserVariableField(sampleDocument, &quot;campusHireVar&quot;, &quot;N&quot;);
    search = new TextNavigation(&quot;\\* Educational certificates&quot;, sampleDocument);
    while (search.hasNext()) {
        TextSelection item = (TextSelection) search.nextSelection();
        FieldSelection fieldSelection = new FieldSelection(item);
        fieldSelection
                .replaceWithConditionField(
                        &quot;campusHireVar == \&quot;Y\&quot;&quot;,
                        &quot;* Educational certificates&quot;,
                        &quot;* Experience certificates from previous employers\n* Copy of resignation/acceptation letter and relieving letter&quot;);
    }
    sampleDocument.save(&quot;OfferTemplate.odt&quot;);
}
</pre></div>


<p>Method <code>generateOfferLetterDocument()</code> is easier. Just load the template document and data docuemnt and fill new value to all of the variables. <code>getVariableFieldByName()</code> is a method of <code>VariableContainer</code> used to iterate variable field by name.</p>
<div class="codehilite"><pre><span></span>public static void generateOfferLetterDocument() throws Exception {
    TextDocument templateDocument = TextDocument.loadDocument(&quot;OfferTemplate.odt&quot;);
    SpreadsheetDocument dataDocument = SpreadsheetDocument.loadDocument(&quot;Candidates.ods&quot;);
    Table table = dataDocument.getTableByName(&quot;Sheet1&quot;);
    int rowCount = table.getRowCount();
    for(int i = 1; i &amp;lt rowCount; i++)
    {
        Row row = table.getRowByIndex(i);
        String name = row.getCellByIndex(0).getDisplayText();
        VariableField candidateVar = templateDocument.getVariableFieldByName(&quot;candidateVar&quot;);
        candidateVar.updateField(name, null);
        String jobTitle = row.getCellByIndex(1).getDisplayText();
        VariableField jobTitleVar = templateDocument.getVariableFieldByName(&quot;jobTitleVar&quot;);
        jobTitleVar.updateField(jobTitle, null);
        String branch = row.getCellByIndex(2).getDisplayText();
        VariableField branchVar = templateDocument.getVariableFieldByName(&quot;branchVar&quot;);
        branchVar.updateField(branch, null);
        String isCampusHire = row.getCellByIndex(3).getDisplayText();
        VariableField campusHireVar = templateDocument.getVariableFieldByName(&quot;campusHireVar&quot;);
        campusHireVar.updateField(isCampusHire, null);
        String onBoradDate = row.getCellByIndex(4).getDisplayText();
        VariableField onBoardDateVar = templateDocument.getVariableFieldByName(&quot;onBoardDateVar&quot;);
        onBoardDateVar.updateField(onBoradDate, null);
        templateDocument.save(name+&quot;&#39;s offer letter.odt&quot;);
    }
}
</pre></div>


<p><strong>Download</strong>  </p>
<p>Powered by the Simple Java API for ODF version <a href="../downloads.html">0.5</a>. <br />
You can download the code of this demo from <a href="demo7.zip">here</a>.</p>
    </div>
    
    <div id="footera">
      <div id="copyrighta">
        <p><a href="https://www.libreoffice.org/imprint" target="_blank">Impressum (Legal Info)</a> | <a
            href="https://www.libreoffice.org/privacy" target="_blank">Privacy Policy (Datenschutzerklärung)</a> | <a
            href="https://www.documentfoundation.org/statutes.pdf" target="_blank">Statutes (non-binding English
            translation)</a> - <a href="https://www.documentfoundation.org/satzung.pdf" target="_blank">Satzung (binding
            German version)</a> | Copyright information: Unless otherwise specified, all text and images on this website
          are licensed under the <a href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank">Creative
            Commons Attribution-Share Alike 3.0 License</a>. This does not include the source code of LibreOffice, which
          is licensed under the <a href="https://www.libreoffice.org/download/license/" target="_blank">Mozilla Public
            License v2.0</a>. “LibreOffice” and “The Document Foundation” are registered trademarks of their
          corresponding registered owners or are in actual use as trademarks in one or more countries. Their respective
          logos and icons are also subject to international copyright laws. Use thereof is explained in our <a
            href="https://wiki.documentfoundation.org/TradeMark_Policy" target="_blank">trademark policy</a>.
          LibreOffice was based on OpenOffice.org.</p>
      </div>
    </div>   
  </div>
</body>

</html>